# **Learning from the Field: Web Exploitation**

## **JWT**

JSON Web Token (JWT) is an Internet standard for creating data with optional signature and optional encryption. JWTs can be signed using a secret (with the HMAC algorithm) or a **public/private** key pair using **RSA** or **ECDSA**.

### **Usage of JWTs**

A very common use of a JWT token is as an API **authentication mechanism**. as well as **Information Exchange**.

#### **Authorization**

Once the user is logged in, the user can access everything allowed with that token.

#### **Information Exchange**

JWTs are useful in sharing information because they are signed by public/private keys as well as we can verify the token if it's tampered or not.

### **JSON Web Token structure**

JWTs cosists of 3 parts seperated by dots.

header.payload.signature

#### **Header**

Header consist of 2 things first one is **type of token** and another thing is **signing algorithm** like HMAC SHA256 or RSA.

For Example:

`Base64:    eyJhbGciOiAiU0gyNTYiLAogICJ0eXAiOiAiSldUIn0=`

After Decoding:

``` 
{
  "alg": "SH256",
  "typ": "JWT"
} 
```

#### **Payload**

Payload contains the claims. Claims are statements about the user and additional data about the user.

For Example:

`Base64: eyJpZCI6ICIxIiwKICAibmFtZSI6ICJBbmFzIEphbWFsIiwKICAiYWRtaW4iOiB0cnVlfQ==`

After Decoding:
```

{
    "id": "1",
  "name": "Anas Jamal",
  "admin": true
} 

```

#### Signature

For creating the signature part you have to take the base64 encoded header and payload, a secret, the algorithm specified in the header, and sign that.

For Example:

```

HMACSHA256(
  base64UrlEncode(header) + "." +
  base64UrlEncode(payload),
  secret
  )
  ```

#### **All 3 Combined**

`Header + Payload + Secret`


```
eyJhbGciOiAiU0gyNTYiLAogICJ0eXAiOiAiSldUIn0.eyJpZCI6ICIxIiwKICAibmFtZSI6ICJBbmFzIEphbWFsIiwKICAiYWRtaW4iOiB0cnVlfQ.6pqwrq5XQFq3453rtw234fuZ4
```